{{ define "main" }}
<!-- CUSTOM TERM TEMPLATE -->
<div class="flex flex-column flex-row-l bg-white series-layout-wrapper" style="min-height: 100vh; width: 100%;">
  <!-- Left Sidebar - Series Navigation -->
  <aside class="w-100 w-25-l pa3 pa4-l bg-white dn db-l aside-full-height" style="border-right: 1px solid #e5e5e5;">
    {{ partial "series-navigation.html" . }}
  </aside>

  <!-- Main Content Area -->
  <div class="w-100 w-75-l ph2 pv3 pa4-l bg-white" style="flex: 1; padding-bottom: 4rem !important; max-width: 100%; box-sizing: border-box;">
    <!-- Mobile Series Menu - Only visible on mobile -->
    {{ partial "series-mobile-menu.html" . }}

    {{/* Get the series slug from the taxonomy term */}}
    {{ $seriesSlug := .Data.Term }}
    {{ $seriesPage := false }}
    {{ $lang := .Site.Language.Lang }}
    
    {{/* Get the series page from section pages */}}
    {{ $seriesSection := .Site.GetPage "section" "series" }}
    {{ if $seriesSection }}
      {{ range $seriesSection.Pages }}
        {{ if and .Params.series_slug (eq .Params.series_slug $seriesSlug) (eq .Lang $lang) }}
          {{ $seriesPage = . }}
        {{ end }}
      {{ end }}
    {{ end }}
    
    {{ if $seriesPage }}
      {{/* Use the series-content partial for gallery and modal functionality */}}
      {{ partial "series-content.html" . }}
    {{ else }}
      <!-- Fallback if series page not found -->
      <h1 class="f4 f3-ns fw6 mb4 black-90" style="font-family: 'Inter', sans-serif; letter-spacing: 0.05em;">
        {{ .Title | upper }}
      </h1>
      <p>Series content not found.</p>
    {{ end }}
    <div class="pb6"></div>
  </div>
</div>

<style>
  /* Hover underline for navigation links */
  .series-nav-link:hover {
    text-decoration: underline !important;
  }
  
  @media (max-width: 60em) {
    .series-nav {
      margin-bottom: 2rem;
    }
    .series-nav ul {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
    }
    .series-nav li {
      margin-bottom: 0;
    }
    
    .gallery-grid {
      grid-template-columns: 1fr !important;
      gap: 2rem 1rem !important;
      margin-left: 0 !important;
      margin-right: 0 !important;
      padding-left: 0 !important;
      padding-right: 0 !important;
    }
  }
  
  /* Prevent horizontal overflow on mobile */
  @media (max-width: 30em) {
    .gallery-grid {
      gap: 1.5rem 0.5rem !important;
      margin-left: 0 !important;
      margin-right: 0 !important;
    }
    
    .gallery-item {
      max-width: 100%;
      overflow: hidden;
    }
    
    .gallery-item img {
      max-width: 100% !important;
      width: 100% !important;
      height: auto !important;
    }
  }
</style>
{{ end }}
