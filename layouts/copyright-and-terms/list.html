{{ define "header" }}
  <!-- Copyright & Terms page - white background, no large header -->
  <header class="bg-white">
    {{ partial "site-navigation.html" . }}
  </header>
{{ end }}

{{ define "main" }}
{{ $currentLang := .Site.Language.Lang }}

{{/* Read the base _index.md file directly */}}
{{ $defaultCopyrightParams := dict }}
{{ $defaultFrontPath := "content/copyright-and-terms/_index.md" }}
{{ if fileExists $defaultFrontPath }}
  {{ $raw := readFile $defaultFrontPath }}
  {{ $front := replaceRE `(?s)^---\s*\n(.*?)\n---.*$` "$1" $raw }}
  {{ $defaultCopyrightParams = $front | transform.Unmarshal }}
{{ end }}

{{/* Get title in current language */}}
{{ $copyrightTitle := "" }}
{{ if eq $currentLang "de" }}
  {{ $copyrightTitle = (index $defaultCopyrightParams "title_de") | default (index $defaultCopyrightParams "title_en") | default "Copyright & Terms of Use" }}
{{ else }}
  {{ $copyrightTitle = (index $defaultCopyrightParams "title_en") | default (index $defaultCopyrightParams "title_de") | default "Copyright & Terms of Use" }}
{{ end }}

{{/* Get copyright text in current language */}}
{{ $copyrightText := "" }}
{{ if eq $currentLang "de" }}
  {{ $copyrightText = index $defaultCopyrightParams "disclaimer_text_de" }}
  {{ if not $copyrightText }}
    {{ $copyrightText = index $defaultCopyrightParams "disclaimer_text_en" }}
  {{ end }}
{{ else }}
  {{ $copyrightText = index $defaultCopyrightParams "disclaimer_text_en" }}
  {{ if not $copyrightText }}
    {{ $copyrightText = index $defaultCopyrightParams "disclaimer_text_de" }}
  {{ end }}
{{ end }}

{{/* Get last updated date - try manual date first, then page Lastmod, then file modification */}}
{{ $lastUpdated := "" }}
{{ $lastUpdatedRaw := index $defaultCopyrightParams "last_updated" }}
{{ if $lastUpdatedRaw }}
  {{ $parsedDate := time $lastUpdatedRaw }}
  {{ if and $parsedDate (not $parsedDate.IsZero) }}
    {{ $lastUpdated = $parsedDate }}
  {{ end }}
{{ end }}
{{/* Fallback to page Lastmod if available */}}
{{ if or (not $lastUpdated) $lastUpdated.IsZero }}
  {{ if and .Lastmod (not .Lastmod.IsZero) }}
    {{ $lastUpdated = .Lastmod }}
  {{ end }}
{{ end }}

<div class="ph2 pv4 ph4-ns pv5-ns bg-white" style="max-width: 800px; margin: 0 auto;">
  <h1 class="f4 f3-ns fw6 mb4 black-90" style="font-family: 'Inter', sans-serif; letter-spacing: 0.05em;">
    {{ $copyrightTitle | upper }}
  </h1>
  
  {{ if and $lastUpdated (not $lastUpdated.IsZero) }}
    {{ $lastUpdatedLabel := "LAST UPDATED:" }}
    {{ if eq $currentLang "de" }}
      {{ $lastUpdatedLabel = "ZULETZT AKTUALISIERT:" }}
    {{ end }}
    <div class="f7 f6-ns mb4 black-60" style="font-family: 'Inter', sans-serif; letter-spacing: 0.05em;">
      <strong>{{ $lastUpdatedLabel }}</strong> {{ $lastUpdated.Format "2 January 2006" | upper }}
    </div>
  {{ end }}
  
  {{ if $copyrightText }}
    <div class="f6 f5-ns lh-copy black-80 copyright-content" style="font-family: 'Inter', sans-serif;">
      {{ $copyrightText | markdownify }}
    </div>
  {{ else }}
    <p class="f6 f5-ns black-70" style="font-family: 'Inter', sans-serif;">{{ if eq $currentLang "de" }}Kein Text verf√ºgbar.{{ else }}No text available.{{ end }}</p>
  {{ end }}
</div>

<style>
  /* Style links within copyright content to be black */
  .copyright-content a {
    color: #000;
    text-decoration: underline;
  }
  
  .copyright-content a:hover {
    color: #000;
    text-decoration: underline;
  }
</style>
{{ end }}

