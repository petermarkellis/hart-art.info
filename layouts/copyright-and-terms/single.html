{{ define "header" }}
  <!-- Copyright & Terms page - white background, no large header -->
  <header class="bg-white">
    {{ partial "site-navigation.html" . }}
  </header>
{{ end }}

{{ define "main" }}
{{ $currentLang := .Site.Language.Lang }}

{{/* Try to get page from Hugo's page context first */}}
{{ $copyrightPage := .Page }}
{{ if not $copyrightPage.Params.disclaimer_text_en }}
  {{ $copyrightPage = .Site.GetPage "page" "copyright-and-terms/_index.md" }}
{{ end }}

{{/* Read the base _index.md file directly as fallback - this ensures we get the content */}}
{{ $defaultCopyrightParams := dict }}
{{ $defaultFrontPath := "content/copyright-and-terms/_index.md" }}
{{ if fileExists $defaultFrontPath }}
  {{ $raw := readFile $defaultFrontPath }}
  {{ $front := replaceRE `(?s)^---\s*\n(.*?)\n---.*$` "$1" $raw }}
  {{ $defaultCopyrightParams = $front | transform.Unmarshal }}
{{ end }}

{{/* Get title in current language - try page params first, then file params */}}
{{ $copyrightTitle := "" }}
{{ if eq $currentLang "de" }}
  {{ $copyrightTitle = $copyrightPage.Params.title_de | default (index $defaultCopyrightParams "title_de") | default $copyrightPage.Params.title_en | default (index $defaultCopyrightParams "title_en") | default $copyrightPage.Title | default "Copyright & Terms of Use" }}
{{ else }}
  {{ $copyrightTitle = $copyrightPage.Params.title_en | default (index $defaultCopyrightParams "title_en") | default $copyrightPage.Params.title_de | default (index $defaultCopyrightParams "title_de") | default $copyrightPage.Title | default "Copyright & Terms of Use" }}
{{ end }}

{{/* Get copyright text in current language - prioritize file params since page params might not load correctly */}}
{{ $copyrightText := "" }}
{{ if eq $currentLang "de" }}
  {{ $copyrightText = (index $defaultCopyrightParams "disclaimer_text_de") | default $copyrightPage.Params.disclaimer_text_de | default (index $defaultCopyrightParams "disclaimer_text_en") | default $copyrightPage.Params.disclaimer_text_en | default "" }}
{{ else }}
  {{ $copyrightText = (index $defaultCopyrightParams "disclaimer_text_en") | default $copyrightPage.Params.disclaimer_text_en | default (index $defaultCopyrightParams "disclaimer_text_de") | default $copyrightPage.Params.disclaimer_text_de | default "" }}
{{ end }}

<div class="ph2 pv4 ph4-ns pv5-ns bg-white" style="max-width: 800px; margin: 0 auto;">
  <h1 class="f4 f3-ns fw6 mb4 black-90" style="font-family: 'Inter', sans-serif; letter-spacing: 0.05em;">
    {{ $copyrightTitle | upper }}
  </h1>
  
  {{ if $copyrightText }}
    <div class="f6 f5-ns lh-copy black-80" style="font-family: 'Inter', sans-serif;">
      {{ $copyrightText | markdownify }}
    </div>
  {{ else }}
    <p class="f6 f5-ns black-70" style="font-family: 'Inter', sans-serif;">{{ if eq $currentLang "de" }}Kein Text verf√ºgbar.{{ else }}No text available.{{ end }}</p>
  {{ end }}
</div>
{{ end }}


